@Library('libreria')_

pipeline{
    agent any
    environment{
        TYPE = "java"
    }
    stages{
        stage("Git"){
            steps{
                script{
                    git.clone(this, "https://github.com/MartiMarch/formacion-jenkins-caso-de-uso-real.git")
                }
            }
        }
        stage("Maven"){
            steps{
                script{
                    dir("formacion-jenkins-caso-de-uso-real"){
                        maven.commonPhases(this)
                    }
                }
            }
        }
        stage("Docker"){
            steps{
                script{
                    docker.prune(this)
                    docker.createDockerfile(this, TYPE)
                    docker.printDockerfile(this)
                    docker.build(this, TYPE)
                }
            }
        }
    }
}
